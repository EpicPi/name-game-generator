{"version":3,"sources":["components/App.js","index.js"],"names":["App","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","state","clubName","mFile","fFile","out1","out2","step","total","completed","fileUpload","bind","assertThisInitialized","textInput","getForm","onSubmit","getLoading","getOutput","processData","getNames","e","target","files","type","alert","value","setState","defineProperty","name","preventDefault","out","failed","JSZip","loadAsync","mzip","mNames","addSingles","filter","includes","fzip","fNames","length","searched","splitNames","getGenders","concat","mapNamesToOut","processData2","objs","_this2","ms","fs","forEach","obj","fullName","gender","first","last","push","married","wa","getWrongAnswers","file","answer1","answer2","answer3","array","i","j","Math","floor","random","temp","list","shuffleArray","names","_this3","n0","n1","probability","removeEnd","split","_this4","na","map","n","trim","pop","join","singles","_this5","zip","relativePath","zipEntry","dir","startsWith","error","message","res0","x","fetch","json","res1","_this6","_out$push","react_default","a","createElement","className","onChange","onClick","react_csv","data","filename","Component","ReactDOM","render","src_components_App","document","getElementById"],"mappings":"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","file":"static/js/main.4883cbd4.chunk.js","sourcesContent":["import React, { Component } from 'react';\nimport './App.css';\nimport JSZip from 'jszip';\nimport { CSVLink } from \"react-csv\";\n\nclass App extends Component {\n  constructor(props){\n    super(props);\n    this.state = {\n      clubName: \"\",\n      mFile: \"\",\n      fFile: \"\",\n      out1: null,\n      out2: null,\n      step: 0,\n      total: 0,\n      completed: 0\n    }\n    this.fileUpload = this.fileUpload.bind(this);\n    this.textInput = this.textInput.bind(this);\n    this.getForm = this.getForm.bind(this);\n    this.onSubmit = this.onSubmit.bind(this);\n    this.getLoading = this.getLoading.bind(this);\n    this.getOutput = this.getOutput.bind(this);\n    this.processData = this.processData.bind(this);\n    this.getNames = this.getNames.bind(this);\n  }\n  fileUpload(e){\n    if(e.target.files[0] && e.target.files[0].type!==\"application/zip\"){\n      alert(\"please upload only zip files of the images\");\n      e.target.value = \"\";\n    }else{\n      this.setState({[e.target.name]: e.target.files[0]});\n    }\n  }\n  textInput(e){\n    this.setState({[e.target.name]: e.target.value});\n  }\n  async onSubmit(e){\n    e.preventDefault();\n    if(!this.state.mFile || !this.state.fFile || !this.state.clubName){\n      alert(\"Please provide all the information\");\n      return;\n    }\n    this.setState({step:1});\n    this.processData()\n  }\n\n  async processData(){\n    let out = []\n    const failed = []\n    \n    const mzip = await JSZip.loadAsync(this.state.mFile);\n    let mNames = this.getNames(mzip);\n    this.addSingles(mNames,\"male\",out);\n    mNames = mNames.filter(name=>name.includes(\"&\"))\n\n    const fzip = await JSZip.loadAsync(this.state.fFile);\n    let fNames = this.getNames(fzip);\n    this.addSingles(fNames,\"female\",out);\n    fNames = fNames.filter(name=>name.includes(\"&\"))\n\n    this.setState({total:fNames.length+mNames.length})\n    this.setState({completed:out.length})\n\n    let searched = []\n\n    mNames = this.splitNames(mNames,failed);\n    mNames =await this.getGenders(mNames,searched);\n\n    fNames = this.splitNames(fNames,failed);\n    fNames = await this.getGenders(fNames,searched);\n\n    out = out.concat(this.mapNamesToOut(mNames,\"male\"));\n    out = out.concat(this.mapNamesToOut(fNames,\"female\"));\n\n    this.setState({out1:out});\n    this.setState({out2:this.processData2(out)});\n    this.setState({step:2});\n  }\n  processData2(objs){\n    const out = []\n    const ms = []\n    const fs = []\n    objs.forEach(obj => {\n      let fullName = \"\"\n      if(obj.gender===\"male\"){\n        fullName = \"Mr.\"+obj.first+\" \"+obj.last;\n        ms.push(fullName);\n      }\n      else {\n        const intro = obj.married===\"true\"?\"Mrs.\":\"Ms.\";\n        fullName = intro+obj.first+\" \"+obj.last;\n        fs.push(fullName);\n      } \n      obj.fullName = fullName;     \n    })\n    objs.forEach(obj => {\n      const wa = this.getWrongAnswers(obj.fullName,obj.gender===\"female\"?fs:ms)\n      out.push({file:obj.file,name:obj.fullName,answer1:wa[0],answer2:wa[1],answer3:wa[2]});\n    });\n    return out;\n  }\n  shuffleArray(array) {\n    for (var i = array.length - 1; i > 0; i--) {\n        var j = Math.floor(Math.random() * (i + 1));\n        var temp = array[i];\n        array[i] = array[j];\n        array[j] = temp;\n    }\n  } \n  getWrongAnswers(name,list){\n    const out =[]\n    this.shuffleArray(list);\n    let i =0;\n    while(out.length<3){\n      if(list[i]!==name)\n        out.push(list[i]);\n      i++;\n    }  \n    return out;\n  }\n  mapNamesToOut(names, gender){\n    const out = []\n    names.forEach(name=>{\n\n      const n0 = name[name.names[0]]\n      const n1 = name[name.names[1]]\n      let i = 0;\n      if(n0.gender === n1.gender){\n        if (n0.gender !== gender)\n          i = (n0.probability > n1.probability)?1:0; // if wrong gender, choose one of lesser prob\n        else\n          i = (n0.probability < n1.probability)?1:0; // if right gender, choose one of more prob\n      }else{\n        i = (n0.gender===gender)?0:1; //if diff genders, choose correct gender\n      }\n      out.push(\n        {\n          file:name.file,\n          first:name.names[i],\n          last:this.removeEnd(name.file).split(\",\")[0],\n          gender,\n          married:\"true\"\n        });\n    });\n    return out;\n  }\n\n  splitNames(names,failed){\n    const splitNames = []\n    names.forEach(file=>{\n      try{\n        let na = this.removeEnd(file).split(',')[1].split(\"&\");\n        na = na.map(n=>n.trim());\n        splitNames.push({names:na,file});\n      }\n      catch(e){\n        failed.push(file);\n      }\n    });\n    return splitNames;\n  }\n  removeEnd(file){\n    let out = file.split('-');\n    out.pop();\n    return out.join(\"\");\n  }\n  addSingles(singles,gender,out){\n    singles = singles.filter(name=>!name.includes(\"&\"))\n    singles.forEach(file=>{\n      const name = this.removeEnd(file);\n      const first = name.split(',')[1].trim();\n      const last = name.split(',')[0].trim();\n      out.push({file,first,last,gender,married:\"false\"})\n    });\n  }\n  getNames(zip){\n    const names = []\n    try{\n      zip.forEach((relativePath, zipEntry) => {\n        if(!zipEntry.dir && !zipEntry.name.startsWith(\"__MACOSX\"))\n          names.push(zipEntry.name);\n      });\n    } catch(error){\n      alert(error.message);\n      this.setState({step:0});\n    }    \n    return names\n  }\n  async getGenders(names, searched){\n    const out = []\n    for (const n of names){\n        \n      let res0 = searched.filter(x=>x.name===n.names[0].split(' ')[0]);\n      if (!res0.length){\n        res0 = await (await fetch(\"https://api.genderize.io/?name=\"+n.names[0].split(' ')[0])).json();\n        if(res0.error){\n          alert(res0.error)\n        }\n        searched.push(res0);\n      }else\n        res0 = res0[0]; \n        \n      let res1 = searched.filter(x=>x.name===n.names[1].split(' ')[0]);  \n      if (!res1.length){\n        res1 = await (await fetch(\"https://api.genderize.io/?name=\"+n.names[1].split(' ')[0])).json();\n        if(res0.error){\n          alert(res0.error)\n        }\n        searched.push(res1);\n      }else\n        res1 = res1[0]; \n        \n      this.setState({completed:this.state.completed+2});\n      out.push({names:n.names,[n.names[0]]:res0,[n.names[1]]:res1,file:n.file});\n    }\n    return out;\n  }\n  getForm(){\n    return (\n      <div className=\"App\">\n      <form>\n        Club Name: <input type=\"text\" value= {this.state.clubName} name=\"clubName\" onChange={this.textInput}/>\n        <br/>\n        <br/>\n        Male zip file: <input type=\"file\" name=\"mFile\" onChange={this.fileUpload}/>\n        <br/>\n        <br/>\n        Female zip file: <input type=\"file\" name=\"fFile\" onChange={this.fileUpload}/>\n        <br/>\n        <br/>\n        <input type=\"submit\" value=\"Process\" onClick={this.onSubmit}/>\n      </form>\n      </div>\n    );\n  }\n  getLoading(){\n    return (\n      <div>\n        Loading\n        <br/>\n        {\"completed \"+this.state.completed}\n        <br/>\n        {\"of \"+this.state.total}\n      </div>\n    )\n  }\n  getOutput(){\n    return (\n      <div>\n        <CSVLink data={this.state.out1} filename={this.state.clubName+\"_data_rich.csv\"}>Download Name-Game CSV for {this.state.clubName} (data rich version)</CSVLink>\n        <br/>\n        <br/>\n        <CSVLink data={this.state.out2} filename={this.state.clubName+\"_wrong_answers.csv\"}>Download Name-Game CSV for {this.state.clubName} (wrong answer generated version)</CSVLink>\n      </div>\n    )\n  }\n  render() {\n    if(this.state.step===0)\n      return this.getForm();\n    else if(this.state.step===1)\n      return this.getLoading()\n    else\n      return this.getOutput()\n  }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './components/App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n\n"],"sourceRoot":""}